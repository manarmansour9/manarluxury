<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Checkout - MyShop</title>
<style>
:root { --accent:#e6007e; --bg:#f8f8f8; --muted:#666; }
body { font-family:Segoe UI,Tahoma,Arial; background:var(--bg); margin:0; color:#222; }
.container { max-width:800px; margin:0 auto; padding:16px; }
h2 { color:var(--accent); }
.cart-summary, .payment-method, .customer-info { background:#fff; padding:16px; border-radius:10px; margin-bottom:20px; box-shadow:0 4px 12px rgba(0,0,0,.1); }
.cart-item { display:flex; justify-content:space-between; align-items:center; margin-bottom:12px; }
.cart-item img { width:60px; border-radius:6px; margin-right:12px; }
.cart-total { font-weight:700; text-align:right; margin-top:12px; }
label { display:block; margin-bottom:10px; font-weight:600; }
input[type="radio"] { margin-right:8px; }
input[type="text"], select, textarea { width:100%; padding:8px; margin-top:4px; border-radius:6px; border:1px solid #ccc; }
textarea { resize:none; }
.pay-btn { background:var(--accent); color:#fff; padding:10px 20px; border:none; border-radius:8px; cursor:pointer; float:right; font-weight:600; transition:0.3s; }
.pay-btn:hover { background:#b30063; }
a.back-btn { display:inline-block; margin-bottom:16px; background:#eee; padding:8px 12px; border-radius:6px; text-decoration:none; color:#222; }
a.back-btn:hover { background:#ddd; }
#cardInfo { display:none; margin-top:12px; }
</style>
</head>
<body>
<div class="container">
<a href="cart.html" class="back-btn">⬅ Back to Cart</a>
<h2>Checkout</h2>

<div class="cart-summary" id="cart-summary"></div>

<div class="customer-info">
  <h3>Customer Information</h3>
  <label>Name <input type="text" id="customerName" placeholder="Your full name"></label>
  <label>Phone <input type="text" id="customerPhone" placeholder="Phone number"></label>

  <label>City
    <select id="customerCity">
      <option value="">-- Select City --</option>
      <option value="Ramallah">Ramallah</option>
      <option value="Jerusalem">Jerusalem</option>
      <option value="Hebron">Hebron</option>
      <option value="Nablus">Nablus</option>
      <option value="Jenin">Jenin</option>
      <option value="Bethlehem">Bethlehem</option>
      <option value="Tulkarm">Tulkarm</option>
      <option value="Qalqilya">Qalqilya</option>
      <option value="Gaza">Gaza</option>
    </select>
  </label>

  <label>Detailed Address
    <textarea id="customerAddress" rows="3" placeholder="Street, building, landmarks..."></textarea>
  </label>
</div>

<div class="payment-method">
  <label>Choose Payment Method:</label>
  <input type="radio" name="payment" value="cash" id="pay-cash" checked> <label for="pay-cash">Cash</label>
  <input type="radio" name="payment" value="card" id="pay-card"> <label for="pay-card">Credit Card</label>

  <div id="cardInfo">
    <label>Card Number <input type="text" id="cardNumber" placeholder="1234 5678 9012 3456"></label>
    <label>Expiry Date <input type="text" id="cardExpiry" placeholder="MM/YY"></label>
    <label>CVV <input type="text" id="cardCVV" placeholder="123"></label>
  </div>
</div>

<!-- Formspree Form -->
<form id="orderForm" action="https://formspree.io/f/xjkeergk" method="POST">
  <input type="hidden" name="customerName" id="formName">
  <input type="hidden" name="customerPhone" id="formPhone">
  <input type="hidden" name="customerCity" id="formCity">
  <input type="hidden" name="customerAddress" id="formAddress">
  <input type="hidden" name="paymentMethod" id="formPayment">
  <input type="hidden" name="cartItems" id="formCart">
  
  <button type="submit" class="pay-btn">Confirm Payment</button>
</form>

<div id="successMsg" style="display:none; margin-top:20px; padding:15px; background:#4CAF50; color:#fff; font-weight:600; border-radius:8px;">✔ Order Sent Successfully! Thank you!</div>
</div>

<script>
function getCart(){ return JSON.parse(localStorage.getItem('cart')||'[]'); }

function renderCartSummary(){
  const cart = getCart();
  const container = document.getElementById('cart-summary');
  container.innerHTML = '';
  if(cart.length===0){ container.innerHTML='<p>Your cart is empty.</p>'; return; }
  let total = 0;
  cart.forEach(item=>{
    const itemTotal = item.price * item.qty;
    total += itemTotal;
    const div = document.createElement('div');
    div.className = 'cart-item';
    div.innerHTML = `<div style="display:flex;align-items:center;">
      <img src="${item.img}" alt="${item.title}">
      <span>${item.title}${item.color ? ' ('+item.color+')' : ''}</span>
    </div>
    <div>$${itemTotal}</div>`;
    container.appendChild(div);
  });
  const totalDiv = document.createElement('div');
  totalDiv.className = 'cart-total';
  totalDiv.textContent = 'Total: $'+total;
  container.appendChild(totalDiv);
}

const cardInfo = document.getElementById('cardInfo');
document.querySelectorAll('input[name="payment"]').forEach(radio=>{
  radio.addEventListener('change', ()=>{
    cardInfo.style.display = radio.value==='card' ? 'block' : 'none';
  });
});

const orderForm = document.getElementById('orderForm');
orderForm.addEventListener('submit', (e)=>{
  const name = document.getElementById('customerName').value.trim();
  const phone = document.getElementById('customerPhone').value.trim();
  const city = document.getElementById('customerCity').value;
  const address = document.getElementById('customerAddress').value.trim();
  const payment = document.querySelector('input[name="payment"]:checked').value;

  if(!name || !phone || !city || !address){ 
    alert("⚠ Please fill all customer info!"); 
    e.preventDefault(); 
    return; 
  }

  if(payment==='card'){
    const cardNumber = document.getElementById('cardNumber').value.trim();
    const cardExpiry = document.getElementById('cardExpiry').value.trim();
    const cardCVV = document.getElementById('cardCVV').value.trim();
    if(!cardNumber || !cardExpiry || !cardCVV){ 
      alert("⚠ Please fill all card details!"); 
      e.preventDefault(); 
      return; 
    }
  }

  // جهزي القيم داخل الفورم
  document.getElementById('formName').value = name;
  document.getElementById('formPhone').value = phone;
  document.getElementById('formCity').value = city;
  document.getElementById('formAddress').value = address;
  document.getElementById('formPayment').value = payment;

  const cart = getCart();
  let cartText = cart.map(item=>{
    return `${item.title} x${item.qty}${item.color ? " ("+item.color+")" : ""}`;
  }).join(", ");
  document.getElementById('formCart').value = cartText;

  // امسح السلة
  localStorage.removeItem('cart');
  renderCartSummary();

  // إظهار success message بعد الإرسال
  orderForm.addEventListener("submit", ()=>{
    document.getElementById('successMsg').style.display='block';
  });
});

renderCartSummary();
</script>
</body>
</html>


